{"ast":null,"code":"var _jsxFileName = \"/home/rk32/Apps/ReactJs/insta_challenge/client/src/post/SinglePost.js\";\nimport React, { Component } from \"react\";\nimport { singlePost, remove, like, unlike } from \"../apis/apiPost\";\nimport DefaultPostImg from \"../assets/images/wormhole.jpg\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport LoadingGif from \"../assets/images/loading.gif\";\nimport { isAuthenticated } from \"../auth\";\nimport Swal from \"sweetalert2\";\nimport Comment from \"./Comment\";\nimport grinHearts from \"../assets/images/grin-hearts.svg\";\nimport frown from \"../assets/images/frown-regular.svg\";\n\nclass SinglePost extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      post: \"\",\n      redirectToHome: false,\n      redirectToSignIn: false,\n      loading: false,\n      like: false,\n      likes: 0,\n      comments: []\n    };\n\n    this.checkLike = likes => {\n      const userId = isAuthenticated() && isAuthenticated().user._id;\n\n      let match = likes.indexOf(userId) !== -1;\n      return match;\n    };\n\n    this.componentDidMount = () => {\n      const postId = this.props.match.params.postId;\n      singlePost(postId).then(data => {\n        if (data.error) {\n          console.log(data.error);\n        } else {\n          this.setState({\n            post: data,\n            likes: data.likes.length,\n            like: this.checkLike(data.likes),\n            comments: data.comments\n          });\n        }\n      });\n    };\n\n    this.deletePost = () => {\n      const postId = this.props.match.params.postId;\n      const token = isAuthenticated().token;\n      Swal.fire({\n        title: \"Are you sure?\",\n        text: \"You won't be able to revert this!\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#3085d6\",\n        cancelButtonColor: \"#d33\",\n        confirmButtonText: \"Yes, delete it!\"\n      }).then(result => {\n        if (result.value) {\n          remove(postId, token).then(data => {\n            if (data.error) {\n              console.log(data.error);\n            } else {\n              Swal.fire(\"Deleted!\", \"Your post has been deleted.\", \"success\");\n              this.setState({\n                redirectToHome: true\n              });\n            }\n          });\n        }\n      });\n    };\n\n    this.updateComments = comments => {\n      this.setState({\n        comments\n      });\n    };\n\n    this.likeToggle = () => {\n      if (!isAuthenticated()) {\n        this.setState({\n          redirectToSignIn: true\n        });\n        return false;\n      }\n\n      let callApi = this.state.like ? unlike : like;\n\n      const userId = isAuthenticated().user._id;\n\n      const postId = this.state.post._id;\n      const token = isAuthenticated().token;\n      callApi(userId, token, postId).then(data => {\n        if (data.error) {\n          console.log(data.error);\n        } else {\n          this.setState({\n            like: !this.state.like,\n            likes: data.likes.length\n          });\n        }\n      });\n    };\n\n    this.renderPost = post => {\n      const posterId = post.postedBy ? `/user/${post.postedBy._id}` : \"\";\n      const posterName = post.postedBy ? post.postedBy.name : \"Unknown\";\n      const {\n        like,\n        likes,\n        comments\n      } = this.state;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card-body text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-7\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: `${process.env.REACT_APP_API_URL}/post/photo/${post._id}`,\n        alt: post.title,\n        onError: i => i.target.src = `${DefaultPostImg}`,\n        className: \"img-fluid\",\n        height: \"100\",\n        width: \"100%\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 7\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"lead text-dark\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 9\n        }\n      }, post.description), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-inline-block\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Link, {\n        to: `/`,\n        className: \"btn btn-raised btn-info btn-sm mr-5\",\n        style: {\n          borderRadius: \"12px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-arrow-circle-left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 13\n        }\n      }), \" Back to Post\"), isAuthenticated().user && isAuthenticated().user._id === post.postedBy._id && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Link, {\n        to: `/post/edit/${post._id}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-raised btn-warning btn-sm mr-5\",\n        style: {\n          borderRadius: \"12px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"far fa-edit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 21\n        }\n      }), \" Edit\", \" \")), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-raised btn-danger btn-sm mr-5\",\n        style: {\n          borderRadius: \"12px\"\n        },\n        onClick: this.deletePost,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"far fa-trash-alt\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 19\n        }\n      }), \" Delete\", \" \"))), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 9\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card-body\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"card-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 7\n        }\n      }, \"Posted by \", /*#__PURE__*/React.createElement(Link, {\n        to: `${posterId}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 17\n        }\n      }, posterName, \" \"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 7\n        }\n      }), /*#__PURE__*/React.createElement(\"small\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 10\n        }\n      }, \"on \", new Date(post.created).toDateString())), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 10\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-5 float-left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 11\n        }\n      }, like ? /*#__PURE__*/React.createElement(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 13\n        }\n      }, likes, \" Likes \", /*#__PURE__*/React.createElement(\"img\", {\n        src: grinHearts,\n        alt: \"love\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 29\n        }\n      })) : /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: frown,\n        alt: \"hate\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 13\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"float-right mt-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }\n      }, comments.length, \" Comment\"), /*#__PURE__*/React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-1 float-left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 12\n        }\n      }, like ? /*#__PURE__*/React.createElement(\"button\", {\n        className: \"profile-edit-btn btn-info\",\n        onClick: this.likeToggle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: grinHearts,\n        alt: \"love\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 85\n        }\n      })) : /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-raised btn-info btn-lg waves-effect waves-light btn-block\",\n        onClick: this.likeToggle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: frown,\n        alt: \"hate\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 127\n        }\n      })))))));\n    };\n  }\n\n  render() {\n    const {\n      post,\n      redirectToHome,\n      redirectToSignIn,\n      comments\n    } = this.state;\n\n    if (redirectToHome) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: `/`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 14\n        }\n      });\n    } else if (redirectToSignIn) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/signin\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 14\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 7\n      }\n    }, !post ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \" text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 11\n      }\n    }, \" \", /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img-fluid\",\n      src: LoadingGif,\n      alt: \"loading\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 15\n      }\n    }))) : this.renderPost(post), /*#__PURE__*/React.createElement(Comment, {\n      postId: post._id,\n      comments: comments.reverse(),\n      updateComments: this.updateComments,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default SinglePost;","map":{"version":3,"sources":["/home/rk32/Apps/ReactJs/insta_challenge/client/src/post/SinglePost.js"],"names":["React","Component","singlePost","remove","like","unlike","DefaultPostImg","Link","Redirect","LoadingGif","isAuthenticated","Swal","Comment","SinglePost","state","post","redirectToHome","redirectToSignIn","loading","likes","comments","checkLike","userId","user","_id","match","indexOf","componentDidMount","postId","props","params","then","data","error","console","log","setState","length","deletePost","token","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","result","value","updateComments","likeToggle","callApi","renderPost","posterId","postedBy","posterName","name","process","env","REACT_APP_API_URL","i","target","src","description","borderRadius","Date","created","toDateString","grinHearts","frown","render","reverse"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { singlePost, remove, like, unlike } from \"../apis/apiPost\";\nimport DefaultPostImg from \"../assets/images/wormhole.jpg\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport LoadingGif from \"../assets/images/loading.gif\";\nimport { isAuthenticated } from \"../auth\";\nimport Swal from \"sweetalert2\";\nimport Comment from \"./Comment\";\nimport grinHearts from '../assets/images/grin-hearts.svg'\nimport frown from '../assets/images/frown-regular.svg'\n\nclass SinglePost extends Component {\n  state = {\n    post: \"\",\n    redirectToHome: false,\n    redirectToSignIn: false,\n    loading: false,\n    like: false,\n    likes: 0,\n    comments: []\n  };\n\n  checkLike = likes => {\n    const userId = isAuthenticated() && isAuthenticated().user._id;\n    let match = likes.indexOf(userId) !== -1;\n    return match;\n  };\n\n  componentDidMount = () => {\n    const postId = this.props.match.params.postId;\n    singlePost(postId).then(data => {\n      if (data.error) {\n        console.log(data.error);\n      } else {\n        this.setState({\n          post: data,\n          likes: data.likes.length,\n          like: this.checkLike(data.likes),\n          comments: data.comments\n        });\n        \n      }\n    });\n  };\n\n  deletePost = () => {\n    const postId = this.props.match.params.postId;\n    const token = isAuthenticated().token;\n\n    Swal.fire({\n      title: \"Are you sure?\",\n      text: \"You won't be able to revert this!\",\n      icon: \"warning\",\n      showCancelButton: true,\n      confirmButtonColor: \"#3085d6\",\n      cancelButtonColor: \"#d33\",\n      confirmButtonText: \"Yes, delete it!\"\n    }).then(result => {\n      if (result.value) {\n        remove(postId, token).then(data => {\n          if (data.error) {\n            console.log(data.error);\n          } else {\n            Swal.fire(\"Deleted!\", \"Your post has been deleted.\", \"success\");\n            this.setState({ redirectToHome: true });\n          }\n        });\n      }\n    });\n  };\n\n  updateComments = comments => {\n    this.setState({ comments });\n  };\n\n  likeToggle = () => {\n    if (!isAuthenticated()) {\n      this.setState({ redirectToSignIn: true });\n      return false;\n    }\n    let callApi = this.state.like ? unlike : like;\n    const userId = isAuthenticated().user._id;\n    const postId = this.state.post._id;\n    const token = isAuthenticated().token;\n\n    callApi(userId, token, postId).then(data => {\n      if (data.error) {\n        console.log(data.error);\n      } else {\n        this.setState({\n          like: !this.state.like,\n          likes: data.likes.length\n        });\n      }\n    });\n  };\n\n  renderPost = post => {\n    const posterId = post.postedBy ? `/user/${post.postedBy._id}` : \"\";\n    const posterName = post.postedBy ? post.postedBy.name : \"Unknown\";\n    const { like, likes, comments } = this.state;\n    \n    return (\n      <div className=\"card-body text-center\">\n\n      <div className=\"row no-gutters\">\n      <div className=\"col-md-7\">\n      <img \n          src={`${process.env.REACT_APP_API_URL}/post/photo/${post._id}`}\n          alt={post.title}\n          onError={i => (i.target.src = `${DefaultPostImg}`)}\n          className=\"img-fluid\"\n          height=\"100\"\n          width=\"100%\"\n        />\n        \n\n        <p className=\"lead text-dark\">{post.description}</p>\n        <hr/>\n        <div className=\"d-inline-block\">\n          <Link\n            to={`/`}\n            className=\"btn btn-raised btn-info btn-sm mr-5\"\n            style={{ borderRadius: \"12px\" }}\n          >\n            <i className=\"fas fa-arrow-circle-left\" /> Back to Post\n          </Link>\n          {isAuthenticated().user &&\n            isAuthenticated().user._id === post.postedBy._id && (\n              <>\n                <Link to={`/post/edit/${post._id}`}>\n                  <button\n                    className=\"btn btn-raised btn-warning btn-sm mr-5\"\n                    style={{ borderRadius: \"12px\" }}\n                  >\n                    <i className=\"far fa-edit\" /> Edit{\" \"}\n                  </button>\n                </Link>\n\n                <button\n                  className=\"btn btn-raised btn-danger btn-sm mr-5\"\n                  style={{ borderRadius: \"12px\" }}\n                  onClick={this.deletePost}\n                >\n                  <i className=\"far fa-trash-alt\" /> Delete{\" \"}\n                </button>\n              </>\n            )}\n        </div>\n        <hr/>\n      </div>\n\n      <div className=\"col-md-5\">\n      <div className=\"card-body\">\n      <h5 className=\"card-title\">\n      Posted by <Link to={`${posterId}`}>{posterName} </Link>\n      \n      <br/>\n         <small>on {new Date(post.created).toDateString()}</small> \n         </h5>\n         \n         <br/>\n\n          <div className=\"mt-5 float-left\">\n          {like ? (\n            <h3>\n              {likes} Likes <img src={grinHearts}  alt='love'/>\n             \n            </h3>\n          ) : (\n            <h1>\n            <img src={frown}  alt='hate'/>\n            </h1>\n          )}\n          \n          </div>\n          <div className='float-right mt-5'>{comments.length} Comment</div>\n          \n          <hr/>\n         \n           <div className=\"mt-1 float-left\">\n          {like ? (\n            <button className='profile-edit-btn btn-info' onClick={this.likeToggle}><img src={grinHearts}  alt='love'/></button>\n            \n            ) : (\n              <button className='btn btn-raised btn-info btn-lg waves-effect waves-light btn-block' onClick={this.likeToggle}><img src={frown}  alt='hate'/></button>\n            \n            )}\n            \n          </div> \n\n          \n      \n      </div>\n      </div>\n      </div>\n      \n      </div>\n    );\n  };\n\n  render() {\n    const { post, redirectToHome, redirectToSignIn, comments } = this.state;\n\n    if (redirectToHome) {\n      return <Redirect to={`/`} />;\n    } else if (redirectToSignIn) {\n      return <Redirect to=\"/signin\" />;\n    }\n\n    return (\n      <div className=\"container\">\n        \n        {!post ? (\n          <div className=\" text-center\">\n            {\" \"}\n            <h2>\n              <img className=\"img-fluid\" src={LoadingGif} alt=\"loading\" />\n            </h2>\n          </div>\n        ) : (\n          this.renderPost(post)\n        )}\n        <Comment\n          postId={post._id}\n          comments={comments.reverse()}\n          updateComments={this.updateComments}\n        />\n      </div>\n    );\n  }\n}\n\nexport default SinglePost;\n"]},"metadata":{},"sourceType":"module"}